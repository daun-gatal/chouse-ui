version: '3.8'

services:
  chouse-ui:
    image: ghcr.io/daun-gatal/chouse-ui:latest
    container_name: chouse-ui
    ports:
      - "5521:5521"
    environment:
      NODE_ENV: production
      JWT_SECRET: dev-secret-change-me
      RBAC_ENCRYPTION_KEY: dev-key-change-me
      RBAC_ENCRYPTION_SALT: dev-salt-change-me
      # Uncomment and provide a config.yaml to use hierarchical configuration
      # CHOUSE_CONFIG_PATH: /app/config.yaml
    volumes:
      - ./data:/app/data
      # - ./config.yaml:/app/config.yaml:ro
    restart: unless-stopped

  clickhouse:
    image: clickhouse/clickhouse-server:latest
    container_name: clickhouse-server
    ports:
      - "8123:8123"
    environment:
      CLICKHOUSE_USER: admin
      CLICKHOUSE_PASSWORD: password
      CLICKHOUSE_DEFAULT_ACCESS_MANAGEMENT: 1
    restart: unless-stopped
